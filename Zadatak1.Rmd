```{r}

data_frame <- read.csv("student_data.csv", header = TRUE)

male_data <- subset(data_frame, sex == "M")

male_data <- male_data$G3_mat
  
  
female_data <- subset(data_frame, sex == "F")
female_data <- female_data$G3_mat

```


Kako bismo odgovorili na pitaje postoji li razlika u konačnim ocjenama među spolovima prvo moramo odraditi deskriptivnu statistiku.

Za početak napravimo box plotove za ocjene ovih dvaju populacija.

```{r}

boxplot(male_data, female_data, main="Box plot")


```

Sa boxplota vidimo da postoji mala razlika u medianima uzoraka. Dodatno zanimljivo je uočiti da za obje populacije boxplot je skoro jednak samo je jedna od populacija translatirana. Dodtano vidimo da postoje outlieri, sukladno tome eliminirajmo outliere obje populacije, te pogledajmo histograme populacija.

```{r}
male_Q1 <- quantile(male_data, 0.25)
male_Q3 <- quantile(male_data, 0.75)
male_IRQ <- male_Q3 - male_Q1
male_lower_bound <- male_Q1 - 1.5*male_IRQ
male_upper_bound <- male_Q3 + 1.5*male_IRQ

male_data <- male_data[male_data >= male_lower_bound & male_data <= male_upper_bound]





female_Q1 <- quantile(female_data, 0.25)
female_Q3 <- quantile(female_data, 0.75)
female_IRQ <- female_Q3 - female_Q1
female_lower_bound <- female_Q1 - 1.5*female_IRQ
female_upper_bound <- female_Q3 + 1.5*female_IRQ

female_data <- female_data[female_data >= female_lower_bound & female_data <= female_upper_bound]

par(mfrow = c(1, 2))

hist(male_data)
hist(female_data)

par(mfrow = c(1, 1))

```

Iz histograma vidimo da podatci nisu normalni no za dovoljno velik broj podataka t-test je robustan stoga koristeći Q-Q plot pogledajmo koliko su daleko ove distribucije od normalne.

```{r}

par(mfrow = c(1, 2))
qqnorm(male_data, main = "Male Q-Q plot")
qqline(male_data, col="red", lwd = 2)

qqnorm(female_data, main = "Male Q-Q plot")
qqline(female_data, col="red", lwd = 2)
par(mfrow = c(1, 1))

```

Iz qq plotova vidimo da su podatci  blizu normalnima. Budući da je t-test robustan, tj. podnosi rad s distribucijama koje su skoro normalne on je prikladan u ovoj situaciji. Međutim prije primjene t-testa korisno je provjeriti jesu li devijacije dviju populacija jednake kako bismo mogli primjeniti jaču inačicu t-testa. U tu svrhu koristiti ćemo F-test. 
```{r}
var.test(male_data, female_data)

```

Budući da je H0 f testa da su varijance jednake i uz podatak da je p vrijednost jednaka 0.912 možemo koristit t-test s pretpostavkom nepoznatih ali jednakih varijanci.

```{r}
t.test(male_data, female_data, var.equal = TRUE)

```

Iz p vrijednosti od 0.0185 zaključujemo da na razini značajnosti 95% odbacujemo H0 u korist alternativne hipoteze. Stoga postoji razlika u prosjeku ocjena na završnom ispitu iz matematike između muških i ženskih učenika.